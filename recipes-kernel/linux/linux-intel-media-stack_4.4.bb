inherit kernel
require recipes-kernel/linux/linux-yocto.inc

# Override SRC_URI in a copy of this recipe to point at a different source
# tree if you do not want to build from Linus' tree.
SRC_URI = "https://www.kernel.org/pub/linux/kernel/v4.x/linux-4.4.tar.xz"
SRC_URI[md5sum] = "9a78fa2eb6c68ca5a40ed5af08142599"

SRC_URI += "file://defconfig"

# TODO: Dynamic build a list of pathces
# def all_custom_patches(d):
#     return "all patchs"
#SRC_URI += "${@all_custom_patches(d)}"

SRC_URI += "file://0001-drm-i915-Allow-the-user-to-pass-a-context-to-any-rin.patch"
SRC_URI += "file://0002-drm-i915-Only-grab-timestamps-when-needed.patch"
SRC_URI += "file://0003-drm-i915-Recover-all-available-ringbuffer-space-foll.patch"
SRC_URI += "file://0004-drm-i915-remove-parens-around-revision-ids.patch"
SRC_URI += "file://0005-drm-i915-bxt-add-revision-id-for-A1-stepping-and-use.patch"
SRC_URI += "file://0006-drm-i915-add-helpers-for-platform-specific-revision-.patch"
SRC_URI += "file://0007-drm-i915-Do-not-call-API-requiring-struct_mutex-wher.patch"
SRC_URI += "file://0008-drm-i915-Convert-requests-to-use-struct-fence.patch"
SRC_URI += "file://0009-drm-i915-Removed-now-redudant-parameter-to-i915_gem_.patch"
SRC_URI += "file://0010-drm-i915-Add-per-context-timelines-to-fence-object.patch"
SRC_URI += "file://0011-drm-i915-Delay-the-freeing-of-requests-until-retire-.patch"
SRC_URI += "file://0012-drm-i915-Interrupt-driven-fences.patch"
SRC_URI += "file://0013-drm-i915-Updated-request-structure-tracing.patch"
SRC_URI += "file://0014-drm-i915-Cache-last-IRQ-seqno-to-reduce-IRQ-overhead.patch"
SRC_URI += "file://0015-drm-i915-Add-total-count-to-context-status-debugfs-o.patch"
SRC_URI += "file://0016-drm-i915-Prelude-to-splitting-i915_gem_do_execbuffer.patch"
SRC_URI += "file://0017-drm-i915-Split-i915_dem_do_execbuffer-in-half.patch"
SRC_URI += "file://0018-drm-i915-Cache-request-pointer-in-_submission_final.patch"
SRC_URI += "file://0019-drm-i915-Re-instate-request-uniq-because-it-is-extre.patch"
SRC_URI += "file://0020-drm-i915-Start-of-GPU-scheduler.patch"
SRC_URI += "file://0021-drm-i915-Prepare-retire_requests-to-handle-out-of-or.patch"
SRC_URI += "file://0022-drm-i915-Disable-hardware-semaphores-when-GPU-schedu.patch"
SRC_URI += "file://0023-drm-i915-Force-MMIO-flips-when-scheduler-enabled.patch"
SRC_URI += "file://0024-drm-i915-Added-scheduler-hook-when-closing-DRM-file-.patch"
SRC_URI += "file://0025-drm-i915-Added-scheduler-hook-into-i915_gem_request_.patch"
SRC_URI += "file://0026-drm-i915-Added-deferred-work-handler-for-scheduler.patch"
SRC_URI += "file://0027-drm-i915-Redirect-execbuffer_final-via-scheduler.patch"
SRC_URI += "file://0028-drm-i915-Keep-the-reserved-space-mechanism-happy.patch"
SRC_URI += "file://0029-drm-i915-Added-tracking-locking-of-batch-buffer-obje.patch"
SRC_URI += "file://0030-drm-i915-Hook-scheduler-node-clean-up-into-retire-re.patch"
SRC_URI += "file://0031-drm-i915-Added-scheduler-support-to-__wait_request-c.patch"
SRC_URI += "file://0032-drm-i915-Added-scheduler-support-to-page-fault-handl.patch"
SRC_URI += "file://0033-drm-i915-Added-scheduler-flush-calls-to-ring-throttl.patch"
SRC_URI += "file://0034-drm-i915-Add-scheduler-hook-to-GPU-reset.patch"
SRC_URI += "file://0035-drm-i915-Added-a-module-parameter-to-allow-the-sched.patch"
SRC_URI += "file://0036-drm-i915-Support-for-unflushed-ring-idle.patch"
SRC_URI += "file://0037-drm-i915-Defer-seqno-allocation-until-actual-hardwar.patch"
SRC_URI += "file://0038-drm-i915-Added-trace-points-to-scheduler.patch"
SRC_URI += "file://0039-drm-i915-Added-scheduler-queue-throttling-by-DRM-fil.patch"
SRC_URI += "file://0040-drm-i915-Added-debugfs-interface-to-scheduler-tuning.patch"
SRC_URI += "file://0041-drm-i915-Added-debug-state-dump-facilities-to-schedu.patch"
SRC_URI += "file://0042-drm-i915-Add-early-exit-to-execbuff_final-if-insuffi.patch"
SRC_URI += "file://0043-drm-i915-Added-scheduler-statistic-reporting-to-debu.patch"
SRC_URI += "file://0044-drm-i915-Add-scheduler-support-functions-for-TDR.patch"
SRC_URI += "file://0045-drm-i915-Scheduler-state-dump-via-debugfs.patch"
SRC_URI += "file://0046-drm-i915-Enable-GPU-scheduler-by-default.patch"
SRC_URI += "file://0047-drm-i915-Add-scheduling-priority-to-per-context-para.patch"
SRC_URI += "file://0048-drm-i915-Add-support-for-retro-actively-banning-batc.patch"
SRC_URI += "file://0049-drm-i915-Allow-scheduler-to-manage-inter-ring-object.patch"
SRC_URI += "file://0050-staging-android-sync-Support-sync-points-created-fro.patch"
SRC_URI += "file://0051-staging-android-sync-add-sync_fence_create_dma.patch"
SRC_URI += "file://0052-staging-android-sync-Move-sync-framework-out-of-stag.patch"
SRC_URI += "file://0053-android-sync-Improved-debug-dump-to-dmesg.patch"
SRC_URI += "file://0054-android-sync-Fix-reversed-sense-of-signaled-fence.patch"
SRC_URI += "file://0055-drm-i915-Add-sync-framework-support-to-execbuff-IOCT.patch"
SRC_URI += "file://0056-drm-i915-Add-sync-wait-support-to-scheduler.patch"
SRC_URI += "file://0057-drm-i915-Connecting-execbuff-fences-to-scheduler.patch"
SRC_URI += "file://0058-drm-i915-Add-sync-support-to-the-scheduler-statistic.patch"
SRC_URI += "file://0059-drm-i915-update-ring-space-correctly.patch"
SRC_URI += "file://0060-drm-i915-recalculate-ring-space-after-reset.patch"
SRC_URI += "file://0061-drm-i915-skl-Add-SKL-GT4-PCI-IDs.patch"
SRC_URI += "file://0062-VPG-drm-i915-change-the-default-value-for-the-schedu.patch"
SRC_URI += "file://0063-drm-i915-gen8-Flip-the-48b-switch.patch"
SRC_URI += "file://0064-drm-i915-Add-soft-pinning-API-for-execbuffer.patch"
SRC_URI += "file://0065-drm-i915-Avoid-writing-relocs-with-addresses-in-non-.patch"
SRC_URI += "file://0066-VPG-drm-i915-Add-L3_LRA_1-Register-to-cmdparser-whit.patch"
SRC_URI += "file://0067-VPG-drm-i915-Add-RCS-General-Purpose-Registers-to-pa.patch"
SRC_URI += "file://0068-VPG-drm-i915-Add-WaDisableLSQCROPERFforOCL-for-BDW-S.patch"
SRC_URI += "file://0069-drm-i915-add-register-0x12400-for-ring-1.patch"
SRC_URI += "file://0070-drm-i915-add-registers-needed-by-mfx_transcoder_drm.patch"
SRC_URI += "file://0071-drm-i915-Add-register-0x000124D0-in-command-0x120000.patch"
SRC_URI += "file://0072-drm-i915-add-register-MFC_QP_STATUS_COUNT-for-ring-1.patch"
SRC_URI += "file://0073-drm-i915-add-MFD_MB_COUNT-for-error-status-report.patch"
SRC_URI += "file://0074-VPG-drm-i915-Add-debugfs-entry-for-ring-buffer-monit.patch"
SRC_URI += "file://0075-drm-i915-bdw-Implement-WaDisableFenceDestinationToSL.patch"
SRC_URI += "file://0076-Add-device-ID-for-SKL-ULT-GT3.patch"
SRC_URI += "file://0077-drm-i915-Add-L3SQCREG4-register-to-whitelist-for-IVB.patch"
SRC_URI += "file://0078-drm-i915-flush-scheduled-work-when-userptr-returns-E.patch"
SRC_URI += "file://0079-VPG-i915-MOCS-tables-for-UFO-CL432947.patch"
SRC_URI += "file://0080-VPG-drm-i915-MOCS-table-update-and-auto-generate-sup.patch"
SRC_URI += "file://0081-VPG-drm-i915-Android-MOCS-Tables-with-MESA-CL464323.patch"
SRC_URI += "file://0082-VPG-i915-dump_lrc-extend-dump-size-to-include-MOCS.patch"
SRC_URI += "file://0083-drm-i915-Inspect-subunit-states-on-hangcheck.patch"
SRC_URI += "file://0084-VPG-Add-i915-build-support.patch"
SRC_URI += "file://0085-drm-i915-skl-Fix-DMC-load-on-Skylake-J0-and-K0.patch"
SRC_URI += "file://0086-VPG-drm-i915-update-DMC-firmware-to-ver1_26.patch"
SRC_URI += "file://0087-VPG-drm-i915-OA-regs-configuration-for-MDAPI-TBS.patch"
SRC_URI += "file://0088-drm-i915-gen9-Add-WaOCLCoherentLineFlush.patch"
SRC_URI += "file://0089-drm-i915-skl-Add-missing-SKL-ids.patch"
SRC_URI += "file://0090-VPG-drm-i915-Android-MOCS-Tables-for-CL519294.patch"
SRC_URI += "file://0091-VPG-drm-i915-Exec-flag-to-force-non-IA-Coherent-cach.patch"
SRC_URI += "file://0092-VPG-drm-i915-skl-Disable-rc6-by-default.patch"
SRC_URI += "file://0093-VPG-drm-i915-export-edram-cap-register-to-user-space.patch"
SRC_URI += "file://0094-VPG-drm-i915-Allow-a-render-node-to-use-perfmon-ioct.patch"
SRC_URI += "file://0095-drm-i915-Shut-up-GuC-errors-when-it-s-disabled.patch"
SRC_URI += "file://0096-drm-i915-skl-Default-to-noncoherent-access-up-to-F0.patch"
SRC_URI += "file://0097-drm-i915-mark-GEM-object-pages-dirty-when-mapped-wri.patch"
SRC_URI += "file://0098-drm-i915-Allow-i915_gem_object_get_page-on-userptr-a.patch"
SRC_URI += "file://0099-VPG-drm-i915-sched-fast-dependency-tracking.patch"
SRC_URI += "file://0100-VPG-drm-i915-sched-Thundering-herd.patch"
SRC_URI += "file://0101-VPG-drm-i915-sched-simplified-remove.patch"
SRC_URI += "file://0102-VPG-drm-i915-fix-KW-issues.patch"
SRC_URI += "file://0103-VPG-drm-i915-evict-vm-when-destroy-context.patch"
SRC_URI += "file://0104-VPG-drm-i915-sched-Deserialized-batch-buffer-through.patch"
SRC_URI += "file://0105-VPG-drm-i915-sched-use-hlist-to-track-the-user-id.patch"
SRC_URI += "file://0106-drm-i915-add-MOCS-tables-for-SKL-GT3e-and-GT4e-for-C.patch"
SRC_URI += "file://0107-VPG-drm-i915-sched-fix-use-after-free-issue-with-a-d.patch"
SRC_URI += "file://0108-VPG-drm-i915-sched-In-order-retire.patch"
SRC_URI += "file://0109-VPG-drm-i915-Fix-for-broken-request-in-file-client-l.patch"
SRC_URI += "file://0110-drm-i915-implement-WaIncreaseDefaultTLBEntries.patch"
SRC_URI += "file://0111-Revert-VPG-drm-i915-evict-vm-when-destroy-context.patch"
SRC_URI += "file://0112-drm-i915-Keep-the-per-object-list-of-VMAs-under-cont.patch"
SRC_URI += "file://0113-VPG-drm-i915-Set-PIN_ZONE_4G-end-to-4GB-1M.patch"
SRC_URI += "file://0114-VPG-drm-i915-add-mvp-support.patch"
SRC_URI += "file://0115-VPG-drm-i915-Add-support-for-OCL-Turbo-Boost.patch"
SRC_URI += "file://0116-VPG-drm-i915-skl-add-slice-shutdown-debugfs-interfac.patch"
SRC_URI += "file://0117-VPG-drm-i915-add-trace-point-for-mvp.patch"
SRC_URI += "file://0118-drm-i915-userptr-Hold-mmref-whilst-calling-get-user-.patch"
SRC_URI += "file://0119-drm-i915-Extend-GET_APERTURE-ioctl-to-report-availab.patch"
SRC_URI += "file://0120-VPG-drm-i915-convert-DRM_ERROR-to-DRM_DEBUG_DRIVER-i.patch"
SRC_URI += "file://0121-VPG-drm-i915-Retry-when-force-wake-time-out.patch"
SRC_URI += "file://0122-VPG-drm-i915-fix-panic-after-disabling-scheduler.patch"
SRC_URI += "file://0123-VPG-drm-i915-flush-the-request-during-wait_rendering.patch"
SRC_URI += "file://0124-drm-i915-bdw-Enable-slice-shutdown-debugfs-interface.patch"
SRC_URI += "file://0125-VPG-drm-i915-Move-i915_gem_get_seqno-to-right-place.patch"
SRC_URI += "file://0126-drm-i915-Early-exit-from-rps-worker-if-GPU-is-idle.patch"
SRC_URI += "file://0127-drm-i915-Set-softmin-frequency-when-going-from-idle-.patch"
SRC_URI += "file://0128-drm-i915-Fix-ref-counting-for-RC6-WA-BB-alloc-deallo.patch"
SRC_URI += "file://0129-VPG-drm-i915-fix-compiler-warning-in-gen6_rps_idle.patch"
SRC_URI += "file://0130-VPG-drm-i915-change-print-format-of-scheduler-events.patch"
SRC_URI += "file://0131-VPG-drm-i915-avoid-NULL-pointer-dereference-in-conte.patch"
SRC_URI += "file://0132-VPG-drm-i915-using-iterative-BFS-to-implement-priori.patch"
SRC_URI += "file://0133-VPG-drm-i915-lower-log-level-when-timeout-waiting-GT.patch"
SRC_URI += "file://0134-VPG-drm-i915-share-ppgtt-across-contexts.patch"
SRC_URI += "file://0135-Revert-VPG-drm-i915-share-ppgtt-across-contexts.patch"
SRC_URI += "file://0136-drm-i915-add-new-context_create2-ioctl-to-share-PPGT.patch"
SRC_URI += "file://0137-drm-i915-wait-on-a-scheduler-queue.patch"
SRC_URI += "file://0138-drm-i915-make-file_queue_max-a-scheduler-level-limit.patch"
SRC_URI += "file://0139-drm-i915-call-kunmap_px-on-pt_vaddr.patch"
SRC_URI += "file://0140-drm-i915-gen9-Set-value-of-Indirect-Context-Offset-b.patch"
SRC_URI += "file://0141-VPG-drm-i915-fix-flinked-object-VMA-leak-after-shari.patch"
SRC_URI += "file://0142-VPG-drm-i915-add-missing-SKL-GT2-pci-id.patch"
SRC_URI += "file://0143-VPG-drm-i915-add-more-missing-SKL-GT2-pci-ids.patch"
SRC_URI += "file://0144-VPG-drm-i915-add-new-counts-for-scheduler-nodes-trac.patch"
SRC_URI += "file://0145-VPG-drm-i915-add-a-queue-to-handle-completed-nodes.patch"
SRC_URI += "file://0146-VPG-drm-i915-Set-RING-GT-frequency-multiplier-to-3-1.patch"
SRC_URI += "file://0147-VPG-drm-i915-add-boot-parameter-for-the-ring-multipl.patch"
SRC_URI += "file://0148-VPG-drm-i915-Export-global-reset_count.patch"
SRC_URI += "file://0149-VPG-drm-i915-new-I915_LOAD_BALANCING_HINT-ioctl-for-.patch"
SRC_URI += "file://0150-VPG-drm-i915-prevent-crash-with-.disable_display-par.patch"
SRC_URI += "file://0151-drm-i915-make-i915-the-source-of-acpi-device-ids-for.patch"
SRC_URI += "file://0152-drm-i915-opregion-fill-in-the-CADL-from-connector-li.patch"
SRC_URI += "file://0153-VPG-drm-i915-Dynamic-Slice-Shutdown-v10.patch"

LINUX_VERSION ?= "4.4.0"
LINUX_VERSION_EXTENSION_append = "-custom"

PV = "${LINUX_VERSION}"

S = "${WORKDIR}/linux-4.4"

# Override COMPATIBLE_MACHINE to include your machine in a copy of this recipe
# file. Leaving it empty here ensures an early explicit build failure.
COMPATIBLE_MACHINE = "intel-corei7-64"